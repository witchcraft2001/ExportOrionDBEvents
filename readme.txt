 Export Orion DB v.0.1.110116
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Данная утилита свободно распространятся и может использоваться без ограничений.

Утилита предназначена для выгрузки событий прохода посетителями через турникеты
из базы данных АРМ "Орион" 7.Х ЗАО НВП "Болид" в файлы формата CSV для
последующего импорта в собственные базы данных учета рабочего времени.

Программа может работать как в интерактивном, так и фоновом режиме (например,
вызываемая планировщиком заданий). В интерактивном режиме пока не все функции
реализованы - так функция фильтрации строк доступна только в фоновом режиме.

 Параметры командной строки
~~~~~~~~~~~~~~~~~~~~~~~~~~~~

/pathdb - путь к БД АРМ Орион.

/output - путь к папке, где будут создаваться выходные файлы. При выгрузке
данных создается файл с названием orion_ДДММГГ_ЧЧммСС.csv

/period - период запуска программы (минуты), используется для определения когда
производилась предыдущая выгрузка данных, дабы захватить в текущую выборку все
невыгруженные данные, без дублирования. При этом текущее время округляется до
целых минут, от полученного времени вычитается указанная длина периода и
полученные значения ограничивают порцию выгружаемых данных.

/filter - имя файла с фильтрами. Файл состоит из строк вида:
field=Фильтрующее значение
Строк может быть несколько, если хотя бы одна строка отрабатывает, то запись
попадает в результирующий файл. Данная функция добавлена с целью отфильтровывать
к примеру сотрудников только определенных организаций. При этом вид файла будет
следующим:
Company=ООО Завод
Если параметр /filter не указан, то в выходной файл попадают все строки.

/lastrec - режим в котором выгружаются только новые записи из БД. Программа
сохраняет номер последней выгруженной записи и при последующем экспорте
опирается на него.

/qname - (опционально) название запроса. Используется в режиме /lastrec, этим
идентификатором именуется параметр номер последней выгруженной строки, при
сохранении в файле конфигурации. Имеет смысл если выгрузка данных производится
в несколько потоков с разными настройками/фильтрами. Если не предусматривается
выгрузка информации в несколько этапов, то параметр /qname можно опустить.

/export - запуск фонового процесса выгрузки данных. Если не указывается, то
программа запускается в интерактивном режиме.

Пример использования:
EODB.exe /pathdb d:\dev\cs\ParadoxReader\BASE_SKUD\ /output d:\dev\ /period 60 /filter flt.txt /export

EODB.exe /pathdb d:\dev\cs\ParadoxReader\BASE_SKUD\ /output d:\dev\ /qname firm1 /filter firm1.txt /lastrec /export

EODB.exe /pathdb d:\dev\cs\ParadoxReader\BASE_SKUD\ /output d:\dev\ /lastrec /export

В папке Temp текущего пользователя формируется log-файл ExportOrionDB_ГГММДД.log
с сообщениями о процессе работы.

 Системные требования
~~~~~~~~~~~~~~~~~~~~~~

Установленный Borland Database Engine.

 Решение проблем
~~~~~~~~~~~~~~~~~

Под ОС Windows 7 и старше чтоб не было ошибки при доступе к базе данных
необходимо изменить расположение файла pdoxusrs.net, где будет доступ на
чтение-запись у пользователя, запускающего программу, например %windir%\temp
и подобные. Для этого требуется запустить BDE Administrator (файл  bdeadmin.exe
в папке c:\Program Files (x86)\Common Files\Borland Shared\BDE\), перейти на
вкладку Configuration, выбрать объект Configuration\Drivers\Native\PARADOX.
Далее в свойстве NET DIR необходимо указать для файла настроек папку с полным
доступом для текущего пользователя.

_______________________________________________________________________________
Автор: Дмитрий Михальченков
E-Mail: mikhaltchenkov@gmail.com
11/01/2016